<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Å–Ω–æ–≤—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .game-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        
        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 30px;
            font-weight: bold;
        }
        
        .question-block {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border-left: 5px solid #3498db;
        }
        
        .question-text {
            font-size: 1.3rem;
            margin-bottom: 25px;
            line-height: 1.5;
        }
        
        /* –¢–∏–ø—ã –≤–æ–ø—Ä–æ—Å–æ–≤ */
        .single-choice, .multiple-choice {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .option {
            background: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 18px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .option:hover {
            border-color: #3498db;
            background: #e3f2fd;
            transform: translateY(-2px);
        }
        
        .option.selected {
            border-color: #2ecc71;
            background: #d4edda;
        }
        
        .option.correct {
            border-color: #27ae60;
            background: #d4edda;
        }
        
        .option.incorrect {
            border-color: #e74c3c;
            background: #fadbd8;
        }
        
        .checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #3498db;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .checkbox.checked::after {
            content: '‚úì';
            color: #27ae60;
            font-weight: bold;
            font-size: 18px;
        }
        
        .matching-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        @media (max-width: 768px) {
            .matching-container {
                grid-template-columns: 1fr;
            }
        }
        
        .matching-column {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .matching-item {
            background: white;
            border: 2px solid #3498db;
            border-radius: 10px;
            padding: 15px;
            cursor: move;
            text-align: center;
            font-weight: 500;
        }
        
        .matching-item.dragging {
            opacity: 0.5;
        }
        
        .drop-zone {
            min-height: 60px;
            border: 2px dashed #7f8c8d;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            text-align: center;
            color: #7f8c8d;
            transition: all 0.3s;
        }
        
        .drop-zone.filled {
            border: 2px solid #2ecc71;
            background: #d4edda;
            color: #333;
        }
        
        .drop-zone.over {
            border-color: #f39c12;
            background: #fef5e7;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 150px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #d35400);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .explanation {
            background: #e3f2fd;
            border-left: 4px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            display: none;
        }
        
        .explanation.show {
            display: block;
        }
        
        .result-screen {
            text-align: center;
            padding: 40px 20px;
        }
        
        .result-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .progress-bar {
            height: 10px;
            background: #ecf0f1;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2ecc71, #27ae60);
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        @media (max-width: 768px) {
            .game-container {
                padding: 20px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="game-container" id="gameContainer">
        <div class="header">
            <h1>üéÆ –û—Å–Ω–æ–≤—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è</h1>
            <p class="subtitle">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–Ω–∞–Ω–∏–π</p>
        </div>
        
        <div class="stats" id="stats">
            <div>–í–æ–ø—Ä–æ—Å: <span id="questionNumber">1</span>/5</div>
            <div>–ë–∞–ª–ª—ã: <span id="score">0</span></div>
            <div>–ü—Ä–∞–≤–∏–ª—å–Ω–æ: <span id="correct">0</span></div>
        </div>
        
        <div class="question-block" id="questionBlock">
            <div class="question-text" id="questionText">
                –ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–∞...
            </div>
            
            <div id="answerContainer">
                <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ -->
            </div>
            
            <div class="explanation" id="explanation">
                <strong>üìö –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:</strong>
                <p id="explanationText"></p>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn btn-warning" id="hintBtn">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
            <button class="btn btn-primary" id="checkBtn">‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
            <button class="btn btn-success" id="nextBtn" style="display: none;">‚û°Ô∏è –î–∞–ª–µ–µ</button>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();
        
        // –î–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã
        const questions = [
            {
                type: 'single',
                question: '–ß—Ç–æ —Ç–∞–∫–æ–µ –∞–ª–≥–æ—Ä–∏—Ç–º?',
                options: [
                    '–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥ –¥–ª—è –≠–í–ú',
                    '–ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞ —è–∑—ã–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è',
                    '–¢–æ—á–Ω–æ–µ –ø—Ä–µ–¥–ø–∏—Å–∞–Ω–∏–µ, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–µ–µ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏',
                    '–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞'
                ],
                correct: 2,
                explanation: '–ê–ª–≥–æ—Ä–∏—Ç–º - —ç—Ç–æ –∫–æ–Ω–µ—á–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π, —Ä–µ—à–∞—é—â–∞—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É.'
            },
            {
                type: 'single',
                question: '–ö–∞–∫–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –ù–ï —è–≤–ª—è–µ—Ç—Å—è —Å–≤–æ–π—Å—Ç–≤–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞?',
                options: [
                    '–î–∏—Å–∫—Ä–µ—Ç–Ω–æ—Å—Ç—å',
                    '–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å',
                    '–†–µ–∑—É–ª—å—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å',
                    '–ú–∞—Å—Å–æ–≤–æ—Å—Ç—å'
                ],
                correct: 1,
                explanation: '–ê–ª–≥–æ—Ä–∏—Ç–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º (–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–º), –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è.'
            },
            {
                type: 'multiple',
                question: '–ö–∞–∫–∏–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –ø—Ä–æ—Å—Ç—ã–º (—Å–∫–∞–ª—è—Ä–Ω—ã–º)?',
                options: [
                    '–¶–µ–ª—ã–µ —á–∏—Å–ª–∞',
                    '–ú–∞—Å—Å–∏–≤—ã',
                    '–°—Ç—Ä–æ–∫–∏',
                    '–í–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∏—Å–ª–∞',
                    '–ó–∞–ø–∏—Å–∏',
                    '–õ–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è'
                ],
                correct: [0, 2, 3, 5],
                explanation: '–ü—Ä–æ—Å—Ç—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö: —Ü–µ–ª—ã–µ, –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ, —Å–∏–º–≤–æ–ª—å–Ω—ã–µ, —Å—Ç—Ä–æ–∫–æ–≤—ã–µ, –ª–æ–≥–∏—á–µ—Å–∫–∏–µ. –ú–∞—Å—Å–∏–≤—ã –∏ –∑–∞–ø–∏—Å–∏ - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã.'
            },
            {
                type: 'matching',
                question: '–°–æ–æ—Ç–Ω–µ—Å–∏—Ç–µ –ø–æ–Ω—è—Ç–∏—è —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏:',
                leftItems: ['–ê–ª–≥–æ—Ä–∏—Ç–º', '–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è', '–§—É–Ω–∫—Ü–∏—è', '–ú–∞—Å—Å–∏–≤'],
                rightItems: [
                    '–ò–º–µ–Ω–æ–≤–∞–Ω–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏',
                    '–£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–∞—è —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤',
                    '–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π',
                    '–ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –∑–Ω–∞—á–µ–Ω–∏–µ'
                ],
                correctPairs: {
                    '–ê–ª–≥–æ—Ä–∏—Ç–º': '–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π',
                    '–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è': '–ò–º–µ–Ω–æ–≤–∞–Ω–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏',
                    '–§—É–Ω–∫—Ü–∏—è': '–ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –∑–Ω–∞—á–µ–Ω–∏–µ',
                    '–ú–∞—Å—Å–∏–≤': '–£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–∞—è —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤'
                },
                explanation: '–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.'
            },
            {
                type: 'single',
                question: '–ß—Ç–æ —Ç–∞–∫–æ–µ —Ü–∏–∫–ª —Å –ø—Ä–µ–¥—É—Å–ª–æ–≤–∏–µ–º?',
                options: [
                    '–¶–∏–∫–ª, –≥–¥–µ —É—Å–ª–æ–≤–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ–ª–∞',
                    '–¶–∏–∫–ª, –≥–¥–µ —É—Å–ª–æ–≤–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —Ç–µ–ª–∞',
                    '–¶–∏–∫–ª —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —á–∏—Å–ª–æ–º –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π',
                    '–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª'
                ],
                correct: 1,
                explanation: '–í —Ü–∏–∫–ª–µ —Å –ø—Ä–µ–¥—É—Å–ª–æ–≤–∏–µ–º (while) —É—Å–ª–æ–≤–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–µ–π.'
            }
        ];
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let currentQuestion = 0;
        let score = 0;
        let correctAnswers = 0;
        let selectedAnswers = [];
        let matchedPairs = {};
        
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const elements = {
            questionNumber: document.getElementById('questionNumber'),
            score: document.getElementById('score'),
            correct: document.getElementById('correct'),
            questionText: document.getElementById('questionText'),
            answerContainer: document.getElementById('answerContainer'),
            explanation: document.getElementById('explanation'),
            explanationText: document.getElementById('explanationText'),
            hintBtn: document.getElementById('hintBtn'),
            checkBtn: document.getElementById('checkBtn'),
            nextBtn: document.getElementById('nextBtn')
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            loadQuestion(currentQuestion);
            setupEventListeners();
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–∞
        function loadQuestion(index) {
            if (index >= questions.length) {
                showResults();
                return;
            }
            
            const question = questions[index];
            elements.questionNumber.textContent = index + 1;
            elements.questionText.textContent = question.question;
            elements.answerContainer.innerHTML = '';
            elements.explanation.classList.remove('show');
            elements.nextBtn.style.display = 'none';
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
            selectedAnswers = [];
            matchedPairs = {};
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–∏–ø –≤–æ–ø—Ä–æ—Å–∞
            switch (question.type) {
                case 'single':
                    loadSingleChoice(question);
                    break;
                case 'multiple':
                    loadMultipleChoice(question);
                    break;
                case 'matching':
                    loadMatching(question);
                    break;
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞
        function loadSingleChoice(question) {
            const container = document.createElement('div');
            container.className = 'single-choice';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="checkbox"></div>
                    <span>${option}</span>
                `;
                
                optionElement.dataset.index = index;
                optionElement.addEventListener('click', () => {
                    // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏—Ö
                    document.querySelectorAll('.option').forEach(el => {
                        el.classList.remove('selected');
                        el.querySelector('.checkbox').classList.remove('checked');
                    });
                    
                    // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π
                    optionElement.classList.add('selected');
                    optionElement.querySelector('.checkbox').classList.add('checked');
                    selectedAnswers = [index];
                });
                
                container.appendChild(optionElement);
            });
            
            elements.answerContainer.appendChild(container);
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞
        function loadMultipleChoice(question) {
            const container = document.createElement('div');
            container.className = 'multiple-choice';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="checkbox"></div>
                    <span>${option}</span>
                `;
                
                optionElement.dataset.index = index;
                optionElement.addEventListener('click', () => {
                    optionElement.classList.toggle('selected');
                    optionElement.querySelector('.checkbox').classList.toggle('checked');
                    
                    if (optionElement.classList.contains('selected')) {
                        selectedAnswers.push(index);
                    } else {
                        selectedAnswers = selectedAnswers.filter(i => i !== index);
                    }
                });
                
                container.appendChild(optionElement);
            });
            
            elements.answerContainer.appendChild(container);
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ—Ç–Ω–µ—Å–µ–Ω–∏—è
        function loadMatching(question) {
            const container = document.createElement('div');
            container.className = 'matching-container';
            
            // –õ–µ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü - –ø–æ–Ω—è—Ç–∏—è
            const leftColumn = document.createElement('div');
            leftColumn.className = 'matching-column';
            leftColumn.innerHTML = '<h3>–ü–æ–Ω—è—Ç–∏—è</h3>';
            
            question.leftItems.forEach(item => {
                const dragItem = document.createElement('div');
                dragItem.className = 'matching-item';
                dragItem.textContent = item;
                dragItem.draggable = true;
                dragItem.dataset.item = item;
                
                dragItem.addEventListener('dragstart', handleDragStart);
                leftColumn.appendChild(dragItem);
            });
            
            // –ü—Ä–∞–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
            const rightColumn = document.createElement('div');
            rightColumn.className = 'matching-column';
            rightColumn.innerHTML = '<h3>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</h3>';
            
            question.rightItems.forEach(item => {
                const dropZone = document.createElement('div');
                dropZone.className = 'drop-zone';
                dropZone.textContent = item;
                dropZone.dataset.definition = item;
                
                dropZone.addEventListener('dragover', handleDragOver);
                dropZone.addEventListener('drop', handleDrop);
                rightColumn.appendChild(dropZone);
            });
            
            container.appendChild(leftColumn);
            container.appendChild(rightColumn);
            elements.answerContainer.appendChild(container);
        }
        
        // Drag and Drop –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.item);
            e.target.classList.add('dragging');
        }
        
        function handleDragOver(e) {
            e.preventDefault();
            e.target.classList.add('over');
        }
        
        function handleDrop(e) {
            e.preventDefault();
            e.target.classList.remove('over');
            
            const item = e.dataTransfer.getData('text/plain');
            const definition = e.target.dataset.definition;
            
            if (item && definition) {
                e.target.textContent = `${item} ‚Üí ${definition}`;
                e.target.classList.add('filled');
                matchedPairs[item] = definition;
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞
        function checkAnswer() {
            const question = questions[currentQuestion];
            let isCorrect = false;
            
            switch (question.type) {
                case 'single':
                    isCorrect = selectedAnswers.length === 1 && 
                               selectedAnswers[0] === question.correct;
                    break;
                    
                case 'multiple':
                    if (selectedAnswers.length === question.correct.length) {
                        isCorrect = selectedAnswers.every(answer => 
                            question.correct.includes(answer)
                        );
                    }
                    break;
                    
                case 'matching':
                    isCorrect = JSON.stringify(matchedPairs) === 
                               JSON.stringify(question.correctPairs);
                    break;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            showResult(isCorrect, question.explanation);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç
            if (isCorrect) {
                score += 10;
                correctAnswers++;
                elements.score.textContent = score;
                elements.correct.textContent = correctAnswers;
            }
            
            elements.nextBtn.style.display = 'block';
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        function showResult(isCorrect, explanation) {
            elements.explanationText.textContent = explanation;
            elements.explanation.classList.add('show');
            
            // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
            if (questions[currentQuestion].type === 'single' || 
                questions[currentQuestion].type === 'multiple') {
                
                document.querySelectorAll('.option').forEach((option, index) => {
                    const question = questions[currentQuestion];
                    
                    if (question.type === 'single') {
                        if (index === question.correct) {
                            option.classList.add('correct');
                        } else if (selectedAnswers.includes(index)) {
                            option.classList.add('incorrect');
                        }
                    } else if (question.type === 'multiple') {
                        if (question.correct.includes(index)) {
                            option.classList.add('correct');
                        } else if (selectedAnswers.includes(index)) {
                            option.classList.add('incorrect');
                        }
                    }
                });
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        function showResults() {
            const percentage = Math.round((correctAnswers / questions.length) * 100);
            
            let grade = '';
            if (percentage >= 90) grade = '–û—Ç–ª–∏—á–Ω–æ! üèÜ';
            else if (percentage >= 70) grade = '–•–æ—Ä–æ—à–æ! üëç';
            else if (percentage >= 50) grade = '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ üëå';
            else grade = '–ù—É–∂–Ω–æ –ø–æ–¥—Ç—è–Ω—É—Ç—å –∑–Ω–∞–Ω–∏—è üìö';
            
            elements.questionText.innerHTML = `
                <h2>üèÜ –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!</h2>
                <p>–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ${correctAnswers}/${questions.length}</p>
                <p>–ù–∞–±—Ä–∞–Ω–æ –±–∞–ª–ª–æ–≤: ${score}</p>
                <p>–û—Ü–µ–Ω–∫–∞: ${grade}</p>
            `;
            
            elements.answerContainer.innerHTML = `
                <div class="result-screen">
                    <div class="result-icon">üéØ</div>
                    <h3>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</h3>
                    <p>1. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–µ–æ—Ä–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–∏–∑–∞—Ü–∏–∏</p>
                    <p>2. –ü—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ—Å—å –≤ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –ø—Ä–æ—Å—Ç—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</p>
                    <p>3. –†–µ—à–∞–π—Ç–µ –∑–∞–¥–∞—á–∏ –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</p>
                </div>
            `;
            
            elements.explanation.style.display = 'none';
            elements.hintBtn.style.display = 'none';
            elements.checkBtn.style.display = 'none';
            elements.nextBtn.style.display = 'none';
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Telegram
            setTimeout(() => {
                tg.sendData(JSON.stringify({
                    action: 'game_complete',
                    score: score,
                    correct: correctAnswers,
                    total: questions.length,
                    percentage: percentage
                }));
                
                tg.close();
            }, 3000);
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            elements.hintBtn.addEventListener('click', () => {
                alert('üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —á–∏—Ç–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –∏ –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤!');
            });
            
            elements.checkBtn.addEventListener('click', checkAnswer);
            
            elements.nextBtn.addEventListener('click', () => {
                currentQuestion++;
                loadQuestion(currentQuestion);
            });
        }
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
