<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–û—Å–Ω–æ–≤—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            font-family: 'Comic Sans MS', 'Arial Rounded MT Bold', 'Segoe UI', sans-serif;
            color: #333;
            overflow-x: hidden;
            touch-action: manipulation;
        }
        
        /* –£–ª—É—á—à–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
        .game-container {
            max-width: 100%;
            min-height: 100vh;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            position: relative;
            box-shadow: 0 0 30px rgba(0,0,0,0.1);
        }
        
        @media (min-width: 768px) {
            .game-container {
                max-width: 800px;
                min-height: auto;
                border-radius: 25px;
                margin: 20px auto;
                padding: 30px;
            }
        }
        
        /* –•–µ–¥–µ—Ä —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π */
        .header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 3px dashed #4a6ee0;
            position: relative;
        }
        
        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.8rem;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5rem;
                gap: 10px;
            }
        }
        
        .header .subtitle {
            color: #7f8c8d;
            font-size: 1rem;
            font-weight: 500;
        }
        
        .header::after {
            content: "üéÆ";
            position: absolute;
            right: 0;
            top: 0;
            font-size: 2rem;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –≤–∏–¥–µ –∫–∞—Ä—Ç–æ—á–µ–∫ */
        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 10px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card .number {
            font-size: 1.8rem;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }
        
        .stat-card .label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* –ë–ª–æ–∫ –≤–æ–ø—Ä–æ—Å–∞ */
        .question-block {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 25px;
            border-left: 8px solid #3498db;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
        }
        
        .question-block::before {
            content: "‚ùì";
            position: absolute;
            right: 15px;
            top: 15px;
            font-size: 2rem;
            opacity: 0.1;
        }
        
        .question-text {
            font-size: 1.3rem;
            margin-bottom: 20px;
            line-height: 1.5;
            color: #2c3e50;
            font-weight: 600;
        }
        
        @media (max-width: 480px) {
            .question-text {
                font-size: 1.1rem;
            }
        }
        
        /* –¢–∏–ø—ã –≤–æ–ø—Ä–æ—Å–æ–≤ - —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤ */
        .option-btn {
            background: white;
            border: 3px solid #ddd;
            border-radius: 15px;
            padding: 18px 20px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.1rem;
            font-weight: 500;
            text-align: left;
            position: relative;
            overflow: hidden;
            min-height: 70px;
        }
        
        .option-btn:hover, .option-btn:active {
            border-color: #3498db;
            background: #e3f2fd;
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(52, 152, 219, 0.2);
        }
        
        .option-btn.selected {
            border-color: #2ecc71;
            background: #d4edda;
            transform: scale(1.02);
        }
        
        .option-btn.correct {
            border-color: #27ae60;
            background: #d4edda;
            animation: pulse 0.5s;
        }
        
        .option-btn.incorrect {
            border-color: #e74c3c;
            background: #fadbd8;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .option-number {
            background: #3498db;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
            font-size: 1.2rem;
        }
        
        .option-btn.selected .option-number {
            background: #2ecc71;
        }
        
        /* –î–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ */
        .checkbox {
            width: 28px;
            height: 28px;
            border: 3px solid #3498db;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            background: white;
        }
        
        .checkbox.checked {
            background: #3498db;
            border-color: #3498db;
        }
        
        .checkbox.checked::after {
            content: '‚úì';
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        /* –£–ª—É—á—à–µ–Ω–Ω–æ–µ —Å–æ–æ—Ç–Ω–µ—Å–µ–Ω–∏–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö (–±–µ–∑ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è) */
        .matching-mobile {
            display: grid;
            gap: 15px;
            margin: 20px 0;
        }
        
        .matching-pair {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .matching-term {
            flex: 1;
            min-width: 150px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .matching-arrow {
            font-size: 1.5rem;
            color: #3498db;
        }
        
        .matching-dropdown {
            flex: 1;
            min-width: 150px;
            padding: 15px;
            border: 3px solid #3498db;
            border-radius: 12px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
            font-weight: 500;
            text-align: center;
        }
        
        .matching-dropdown.selected {
            background: #e3f2fd;
            border-color: #2ecc71;
        }
        
        /* –ù–æ–≤—ã–π —Ç–∏–ø: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å */
        .sequence-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 20px 0;
        }
        
        .sequence-item {
            background: white;
            border: 3px solid #f39c12;
            border-radius: 15px;
            padding: 18px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: move;
            font-size: 1.1rem;
            font-weight: 500;
            position: relative;
            transition: transform 0.3s;
            min-height: 70px;
        }
        
        .sequence-item.dragging {
            opacity: 0.5;
            transform: scale(1.05);
        }
        
        .sequence-number {
            background: #f39c12;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
            font-size: 1.2rem;
        }
        
        .sequence-handle {
            margin-left: auto;
            color: #7f8c8d;
            font-size: 1.5rem;
        }
        
        /* –ù–æ–≤—ã–π —Ç–∏–ø: –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ */
        .fill-blanks {
            background: #fef9e7;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 3px dashed #f1c40f;
        }
        
        .blank-text {
            font-size: 1.2rem;
            line-height: 1.8;
            margin-bottom: 20px;
        }
        
        .blank {
            display: inline-block;
            min-width: 120px;
            padding: 10px 15px;
            margin: 0 5px;
            border: 2px dashed #7f8c8d;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            text-align: center;
            font-weight: 500;
            position: relative;
        }
        
        .blank.filled {
            border: 2px solid #3498db;
            background: #e3f2fd;
        }
        
        .blank-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .blank-option {
            padding: 10px 20px;
            background: white;
            border: 2px solid #3498db;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .blank-option:hover {
            background: #3498db;
            color: white;
        }
        
        .blank-option.used {
            opacity: 0.5;
            cursor: not-allowed;
            text-decoration: line-through;
        }
        
        /* –ù–æ–≤—ã–π —Ç–∏–ø: –ù–∞–π–¥–∏ –æ—à–∏–±–∫—É */
        .find-error {
            background: #fff5f5;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 3px solid #e74c3c;
            font-family: 'Courier New', monospace;
        }
        
        .code-line {
            padding: 10px 15px;
            margin: 5px 0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: background 0.3s;
            font-size: 1.1rem;
        }
        
        .code-line:hover {
            background: rgba(231, 76, 60, 0.1);
        }
        
        .code-line.selected {
            background: rgba(231, 76, 60, 0.2);
            border-left: 4px solid #e74c3c;
        }
        
        .line-number {
            color: #7f8c8d;
            font-weight: bold;
            min-width: 30px;
        }
        
        /* –ù–æ–≤—ã–π —Ç–∏–ø: –°–æ–±–µ—Ä–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É */
        .build-program {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .code-block {
            background: white;
            border: 3px solid #9b59b6;
            border-radius: 15px;
            padding: 20px;
            cursor: move;
            text-align: center;
            font-weight: 500;
            transition: all 0.3s;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .code-block:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(155, 89, 182, 0.2);
        }
        
        .program-area {
            grid-column: 1 / -1;
            min-height: 200px;
            border: 3px dashed #9b59b6;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: flex-start;
        }
        
        .program-area .code-block {
            margin: 5px;
        }
        
        /* –û–±—ä—è—Å–Ω–µ–Ω–∏–µ */
        .explanation {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 6px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 15px;
            display: none;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .explanation.show {
            display: block;
        }
        
        .explanation h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 30px;
            position: sticky;
            bottom: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 20px;
            box-shadow: 0 -5px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            z-index: 100;
        }
        
        @media (max-width: 480px) {
            .controls {
                grid-template-columns: 1fr;
                position: fixed;
                left: 20px;
                right: 20px;
                bottom: 10px;
            }
        }
        
        .btn {
            padding: 18px 25px;
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-height: 60px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn:active {
            transform: scale(0.95);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #d35400);
            color: white;
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
        }
        
        /* –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
        .result-screen {
            text-align: center;
            padding: 30px 20px;
            animation: fadeIn 1s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .result-icon {
            font-size: 5rem;
            margin-bottom: 20px;
            animation: celebrate 2s infinite;
        }
        
        @keyframes celebrate {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.2) rotate(-10deg); }
            50% { transform: scale(1.2) rotate(10deg); }
            75% { transform: scale(1.2) rotate(-10deg); }
        }
        
        .progress-bar {
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            margin: 30px 0;
            overflow: hidden;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2ecc71, #27ae60);
            border-radius: 10px;
            transition: width 1s ease;
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.4),
                transparent
            );
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è */
        @media (max-width: 768px) {
            .game-container {
                padding: 15px;
            }
            
            .question-block {
                padding: 20px;
            }
            
            .option-btn {
                padding: 16px;
                min-height: 60px;
                font-size: 1rem;
            }
            
            .btn {
                padding: 16px;
                font-size: 1rem;
                min-height: 55px;
            }
            
            .matching-pair {
                flex-direction: column;
                gap: 10px;
            }
            
            .matching-term, .matching-dropdown {
                width: 100%;
                min-width: auto;
            }
            
            .matching-arrow {
                transform: rotate(90deg);
            }
        }
        
        /* –î–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-width: 360px) {
            .header h1 {
                font-size: 1.3rem;
            }
            
            .stat-card {
                padding: 12px 8px;
            }
            
            .stat-card .number {
                font-size: 1.5rem;
            }
            
            .question-text {
                font-size: 1rem;
            }
        }
        
        /* –£–ª—É—á—à–µ–Ω–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
        .fade-in {
            animation: fadeInUp 0.6s ease-out;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* –ü–æ–¥—Å–∫–∞–∑–∫–∏ */
        .hint-bubble {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #f39c12;
            color: white;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(243, 156, 18, 0.3);
            display: none;
            z-index: 1000;
            max-width: 300px;
            animation: slideInRight 0.5s ease-out;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .hint-bubble.show {
            display: block;
        }
    </style>
</head>
<body>
    <div class="game-container" id="gameContainer">
        <div class="header">
            <h1><i class="fas fa-robot"></i> –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–µ—Ç–µ–π</h1>
            <p class="subtitle">–£—á–∏–º—Å—è –∫–æ–¥–∏—Ç—å –≤–µ—Å–µ–ª–æ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ!</p>
        </div>
        
        <div class="stats" id="stats">
            <div class="stat-card">
                <span class="number" id="questionNumber">1</span>
                <span class="label">–í–û–ü–†–û–°</span>
            </div>
            <div class="stat-card">
                <span class="number" id="score">0</span>
                <span class="label">–ë–ê–õ–õ–´</span>
            </div>
            <div class="stat-card">
                <span class="number" id="correct">0</span>
                <span class="label">–ü–†–ê–í–ò–õ–¨–ù–û</span>
            </div>
        </div>
        
        <div class="question-block fade-in" id="questionBlock">
            <div class="question-text" id="questionText">
                –ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–∞...
            </div>
            
            <div id="answerContainer">
                <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ -->
            </div>
            
            <div class="explanation" id="explanation">
                <h4><i class="fas fa-lightbulb"></i> –û–ë–™–Ø–°–ù–ï–ù–ò–ï:</h4>
                <p id="explanationText"></p>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn btn-warning" id="hintBtn">
                <i class="fas fa-lightbulb"></i> –ü–æ–¥—Å–∫–∞–∑–∫–∞
            </button>
            <button class="btn btn-primary" id="checkBtn">
                <i class="fas fa-check"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
            </button>
            <button class="btn btn-success" id="nextBtn" style="display: none;">
                <i class="fas fa-arrow-right"></i> –î–∞–ª–µ–µ
            </button>
        </div>
        
        <div class="hint-bubble" id="hintBubble">
            –ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å!
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();
        
        // –ù–æ–≤—ã–µ —Ç–∏–ø—ã –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –¥–µ—Ç–µ–π
        const questions = [
            {
                type: 'single',
                question: '–ß—Ç–æ —Ç–∞–∫–æ–µ –∞–ª–≥–æ—Ä–∏—Ç–º?',
                options: [
                    '–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥ –¥–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞',
                    '–ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞ —è–∑—ã–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è',
                    '–¢–æ—á–Ω–æ–µ –ø—Ä–µ–¥–ø–∏—Å–∞–Ω–∏–µ, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–µ–µ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏',
                    '–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞'
                ],
                correct: 2,
                explanation: '–ê–ª–≥–æ—Ä–∏—Ç–º - —ç—Ç–æ –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏. –ö–∞–∫ —Ä–µ—Ü–µ–ø—Ç –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è —Ç–æ—Ä—Ç–∞! üéÇ'
            },
            {
                type: 'multiple',
                question: '–ö–∞–∫–∏–µ —Ç–∏–ø—ã —Ü–∏–∫–ª–æ–≤ —Ç—ã –∑–Ω–∞–µ—à—å? (–í—ã–±–µ—Ä–∏ –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ)',
                options: [
                    '–¶–∏–∫–ª "–ø–æ–∫–∞" (while)',
                    '–¶–∏–∫–ª "–¥–ª—è" (for)',
                    '–¶–∏–∫–ª "–¥–æ —Ç–µ—Ö –ø–æ—Ä" (do-while)',
                    '–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)'
                ],
                correct: [0, 1, 2, 3],
                explanation: '–¶–∏–∫–ª—ã –ø–æ–º–æ–≥–∞—é—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –º–Ω–æ–≥–æ —Ä–∞–∑, –∫–∞–∫ –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–µ—Å—è –¥–≤–∏–∂–µ–Ω–∏–µ –≤ —Ç–∞–Ω—Ü–µ! üíÉ'
            },
            {
                type: 'matching',
                question: '–°–æ–µ–¥–∏–Ω–∏ –ø–æ–Ω—è—Ç–∏—è —Å –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è–º–∏:',
                leftItems: ['–ê–ª–≥–æ—Ä–∏—Ç–º', '–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è', '–§—É–Ω–∫—Ü–∏—è', '–ë–∞–≥'],
                rightItems: [
                    '–ò–º–µ–Ω–æ–≤–∞–Ω–Ω–∞—è "–∫–æ—Ä–æ–±–æ—á–∫–∞" –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö',
                    '–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è',
                    '–û—à–∏–±–∫–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ',
                    '–ü–æ–ª–µ–∑–Ω–∞—è –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞'
                ],
                correctPairs: {
                    '–ê–ª–≥–æ—Ä–∏—Ç–º': '–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è',
                    '–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è': '–ò–º–µ–Ω–æ–≤–∞–Ω–Ω–∞—è "–∫–æ—Ä–æ–±–æ—á–∫–∞" –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö',
                    '–§—É–Ω–∫—Ü–∏—è': '–ü–æ–ª–µ–∑–Ω–∞—è –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞',
                    '–ë–∞–≥': '–û—à–∏–±–∫–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ'
                },
                explanation: '–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –¢–µ–ø–µ—Ä—å —Ç—ã –∑–Ω–∞–µ—à—å –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è! üéØ'
            },
            {
                type: 'sequence',
                question: '–†–∞—Å—Å—Ç–∞–≤—å —à–∞–≥–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ "–ö–∞–∫ –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∫–æ—Ç–∞" –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:',
                steps: [
                    '–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∫—Ä—É–≥ –¥–ª—è –≥–æ–ª–æ–≤—ã',
                    '–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ—É–≥–æ–ª—å–Ω—ã–µ —É—à–∫–∏',
                    '–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å –≥–ª–∞–∑–∞ –∏ –Ω–æ—Å',
                    '–î–æ–±–∞–≤–∏—Ç—å —É—Å—ã –∏ —É–ª—ã–±–∫—É',
                    '–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å —Ç–µ–ª–æ –∏ –ª–∞–ø–∫–∏'
                ],
                correctOrder: [0, 1, 2, 4, 3],
                explanation: '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –¢–∞–∫ –º—ã —Ä–∏—Å—É–µ–º –∫–æ—Ç–∏–∫–∞ —à–∞–≥ –∑–∞ —à–∞–≥–æ–º! üê±'
            },
            {
                type: 'fill-blanks',
                question: '–ó–∞–ø–æ–ª–Ω–∏ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ:',
                code: '–î–ª—è i –æ—Ç 1 –¥–æ 10:<br>    <span class="blank" data-id="1">______</span>("–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!")<br><br>–ï—Å–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ > 30:<br>    <span class="blank" data-id="2">______</span>("–ñ–∞—Ä–∫–æ!")<br>–ò–Ω–∞—á–µ:<br>    <span class="blank" data-id="3">______</span>("–ü—Ä–æ—Ö–ª–∞–¥–Ω–æ")',
                blanks: {
                    '1': ['–Ω–∞–ø–µ—á–∞—Ç–∞—Ç—å', '–≤—ã–≤–µ—Å—Ç–∏', 'print'],
                    '2': ['—Å–∫–∞–∑–∞—Ç—å', '—Å–æ–æ–±—â–∏—Ç—å', '–≤—ã–≤–µ—Å—Ç–∏'],
                    '3': ['–Ω–∞–ø–∏—Å–∞—Ç—å', '–ø–æ–∫–∞–∑–∞—Ç—å', '–≤—ã–≤–µ—Å—Ç–∏']
                },
                correct: ['–≤—ã–≤–µ—Å—Ç–∏', '—Å–æ–æ–±—â–∏—Ç—å', '–≤—ã–≤–µ—Å—Ç–∏'],
                explanation: '–ú–æ–ª–æ–¥–µ—Ü! –¢–µ–ø–µ—Ä—å –ø—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ! üëè'
            },
            {
                type: 'find-error',
                question: '–ù–∞–π–¥–∏ –æ—à–∏–±–∫—É –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ:',
                code: [
                    '1. –ù–∞—á–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É',
                    '2. –°–ø—Ä–æ—Å–∏—Ç—å –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
                    '3. –ï—Å–ª–∏ –∏–º—è = "–ê–Ω–Ω–∞"',
                    '4.     –ù–∞–ø–µ—á–∞—Ç–∞—Ç—å "–ü—Ä–∏–≤–µ—Ç, –ê–Ω–Ω–∞!"',
                    '5. –ò–Ω–∞—á–µ –µ—Å–ª–∏ –∏–º—è = "–ò–≤–∞–Ω"',
                    '6.     –ù–∞–ø–µ—á–∞—Ç–∞—Ç—å "–ü—Ä–∏–≤–µ—Ç, –ò–≤–∞–Ω!"',
                    '7. –ò–Ω–∞—á–µ',
                    '8.     –ù–∞–ø–µ—á–∞—Ç–∞—Ç—å "–ü—Ä–∏–≤–µ—Ç"',
                    '9. –ö–æ–Ω–µ—Ü –µ—Å–ª–∏',
                    '10. –ö–æ–Ω–µ—Ü –ø—Ä–æ–≥—Ä–∞–º–º—ã'
                ],
                errorLine: 7,
                explanation: '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –ü–æ—Å–ª–µ "–ò–Ω–∞—á–µ" –Ω–µ –Ω—É–∂–Ω–æ —Å—Ç–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–∏–µ. –¢—ã –Ω–∞—à–µ–ª –±–∞–≥! üêõ'
            },
            {
                type: 'build-program',
                question: '–°–æ–±–µ—Ä–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É –¥–ª—è —Ä–æ–±–æ—Ç–∞, —á—Ç–æ–±—ã –æ–Ω –ø–æ–∑–¥–æ—Ä–æ–≤–∞–ª—Å—è:',
                blocks: [
                    '–ù–ê–ß–ê–¢–¨',
                    '–ü–û–í–¢–û–†–ò 3 –†–ê–ó–ê',
                    '–°–ö–ê–ó–ê–¢–¨ "–ü–†–ò–í–ï–¢"',
                    '–ñ–î–ê–¢–¨ 1 –°–ï–ö–£–ù–î–£',
                    '–ü–û–í–ï–†–ù–£–¢–¨–°–Ø',
                    '–ö–û–ù–ï–¶ –ü–û–í–¢–û–†–ï–ù–ò–Ø',
                    '–°–ö–ê–ó–ê–¢–¨ "–ü–û–ö–ê"',
                    '–ö–û–ù–ï–¶'
                ],
                correctOrder: [0, 1, 2, 3, 4, 5, 6, 7],
                explanation: '–°—É–ø–µ—Ä! –†–æ–±–æ—Ç –±—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ 3 —Ä–∞–∑–∞, –ø–æ–≤–æ—Ä–∞—á–∏–≤–∞—è—Å—å –∫–∞–∂–¥—ã–π —Ä–∞–∑! ü§ñ'
            }
        ];
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let currentQuestion = 0;
        let score = 0;
        let correctAnswers = 0;
        let selectedAnswers = [];
        let dragItems = [];
        let activeBlank = null;
        
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const elements = {
            questionNumber: document.getElementById('questionNumber'),
            score: document.getElementById('score'),
            correct: document.getElementById('correct'),
            questionText: document.getElementById('questionText'),
            answerContainer: document.getElementById('answerContainer'),
            explanation: document.getElementById('explanation'),
            explanationText: document.getElementById('explanationText'),
            hintBtn: document.getElementById('hintBtn'),
            checkBtn: document.getElementById('checkBtn'),
            nextBtn: document.getElementById('nextBtn'),
            hintBubble: document.getElementById('hintBubble')
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            loadQuestion(currentQuestion);
            setupEventListeners();
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
            document.querySelectorAll('.fade-in').forEach(el => {
                el.style.animationDelay = '0.2s';
            });
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–∞
        function loadQuestion(index) {
            if (index >= questions.length) {
                showResults();
                return;
            }
            
            const question = questions[index];
            elements.questionNumber.textContent = index + 1;
            elements.questionText.textContent = question.question;
            elements.answerContainer.innerHTML = '';
            elements.explanation.classList.remove('show');
            elements.nextBtn.style.display = 'none';
            
            // –°–±—Ä–æ—Å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
            selectedAnswers = [];
            activeBlank = null;
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–ø–∞ –≤–æ–ø—Ä–æ—Å–∞
            switch (question.type) {
                case 'single':
                    loadSingleChoice(question);
                    break;
                case 'multiple':
                    loadMultipleChoice(question);
                    break;
                case 'matching':
                    loadMatchingMobile(question);
                    break;
                case 'sequence':
                    loadSequence(question);
                    break;
                case 'fill-blanks':
                    loadFillBlanks(question);
                    break;
                case 'find-error':
                    loadFindError(question);
                    break;
                case 'build-program':
                    loadBuildProgram(question);
                    break;
            }
        }
        
        // –û–¥–∏–Ω–æ—á–Ω—ã–π –≤—ã–±–æ—Ä
        function loadSingleChoice(question) {
            const container = document.createElement('div');
            container.className = 'options-container';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('button');
                optionElement.className = 'option-btn';
                optionElement.innerHTML = `
                    <span class="option-number">${index + 1}</span>
                    <span>${option}</span>
                `;
                
                optionElement.addEventListener('click', () => {
                    // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏—Ö
                    document.querySelectorAll('.option-btn').forEach(el => {
                        el.classList.remove('selected');
                    });
                    
                    // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π
                    optionElement.classList.add('selected');
                    selectedAnswers = [index];
                });
                
                container.appendChild(optionElement);
            });
            
            elements.answerContainer.appendChild(container);
        }
        
        // –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä
        function loadMultipleChoice(question) {
            const container = document.createElement('div');
            container.className = 'options-container';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('button');
                optionElement.className = 'option-btn';
                optionElement.innerHTML = `
                    <div class="checkbox"></div>
                    <span>${option}</span>
                `;
                
                optionElement.addEventListener('click', () => {
                    optionElement.classList.toggle('selected');
                    optionElement.querySelector('.checkbox').classList.toggle('checked');
                    
                    if (optionElement.classList.contains('selected')) {
                        selectedAnswers.push(index);
                    } else {
                        selectedAnswers = selectedAnswers.filter(i => i !== index);
                    }
                });
                
                container.appendChild(optionElement);
            });
            
            elements.answerContainer.appendChild(container);
        }
        
        // –°–æ–æ—Ç–Ω–µ—Å–µ–Ω–∏–µ (–º–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        function loadMatchingMobile(question) {
            const container = document.createElement('div');
            container.className = 'matching-mobile';
            
            question.leftItems.forEach((term, index) => {
                const pairDiv = document.createElement('div');
                pairDiv.className = 'matching-pair';
                
                const termDiv = document.createElement('div');
                termDiv.className = 'matching-term';
                termDiv.textContent = term;
                termDiv.dataset.term = term;
                
                const arrow = document.createElement('div');
                arrow.className = 'matching-arrow';
                arrow.innerHTML = '‚Üí';
                
                const dropdown = document.createElement('select');
                dropdown.className = 'matching-dropdown';
                dropdown.innerHTML = `<option value="">–í—ã–±–µ—Ä–∏ –æ—Ç–≤–µ—Ç</option>`;
                
                question.rightItems.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item;
                    option.textContent = item;
                    dropdown.appendChild(option);
                });
                
                dropdown.addEventListener('change', function() {
                    if (this.value) {
                        this.classList.add('selected');
                    } else {
                        this.classList.remove('selected');
                    }
                });
                
                pairDiv.appendChild(termDiv);
                pairDiv.appendChild(arrow);
                pairDiv.appendChild(dropdown);
                container.appendChild(pairDiv);
            });
            
            elements.answerContainer.appendChild(container);
        }
        
        // –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
        function loadSequence(question) {
            const container = document.createElement('div');
            container.className = 'sequence-container';
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —à–∞–≥–∏
            const shuffledSteps = [...question.steps]
                .map((step, index) => ({step, index}))
                .sort(() => Math.random() - 0.5);
            
            shuffledSteps.forEach((item, position) => {
                const stepElement = document.createElement('div');
                stepElement.className = 'sequence-item';
                stepElement.dataset.index = item.index;
                stepElement.innerHTML = `
                    <div class="sequence-number">${position + 1}</div>
                    <div class="sequence-text">${item.step}</div>
                    <div class="sequence-handle">‚ò∞</div>
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º touch/mouse —Å–æ–±—ã—Ç–∏—è –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
                makeDraggable(stepElement, container);
                container.appendChild(stepElement);
            });
            
            elements.answerContainer.appendChild(container);
        }
        
        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤
        function loadFillBlanks(question) {
            const container = document.createElement('div');
            container.className = 'fill-blanks';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏
            const textDiv = document.createElement('div');
            textDiv.className = 'blank-text';
            textDiv.innerHTML = question.code;
            
            // –î–µ–ª–∞–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º–∏
            setTimeout(() => {
                textDiv.querySelectorAll('.blank').forEach(blank => {
                    blank.addEventListener('click', function() {
                        // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–ø—É—Å–∫–æ–≤
                        textDiv.querySelectorAll('.blank').forEach(b => {
                            b.classList.remove('active');
                        });
                        
                        // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π
                        this.classList.add('active');
                        activeBlank = this;
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
                        showHint('–í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–∏–∂–µ, —á—Ç–æ–±—ã –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫!');
                    });
                });
            }, 100);
            
            // –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'blank-options';
            
            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
            const allOptions = [];
            Object.values(question.blanks).forEach(arr => {
                arr.forEach(opt => {
                    if (!allOptions.includes(opt)) allOptions.push(opt);
                });
            });
            
            // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
            allOptions.forEach(option => {
                const optionBtn = document.createElement('button');
                optionBtn.className = 'blank-option';
                optionBtn.textContent = option;
                
                optionBtn.addEventListener('click', function() {
                    if (activeBlank) {
                        activeBlank.textContent = option;
                        activeBlank.classList.add('filled');
                        activeBlank.classList.remove('active');
                        this.classList.add('used');
                        activeBlank = null;
                    }
                });
                
                optionsDiv.appendChild(optionBtn);
            });
            
            container.appendChild(textDiv);
            container.appendChild(optionsDiv);
            elements.answerContainer.appendChild(container);
        }
        
        // –ù–∞–π–¥–∏ –æ—à–∏–±–∫—É
        function loadFindError(question) {
            const container = document.createElement('div');
            container.className = 'find-error';
            
            question.code.forEach((line, index) => {
                const lineDiv = document.createElement('div');
                lineDiv.className = 'code-line';
                lineDiv.innerHTML = `
                    <span class="line-number">${index + 1}.</span>
                    <span class="line-text">${line}</span>
                `;
                
                lineDiv.addEventListener('click', function() {
                    // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–æ–∫
                    container.querySelectorAll('.code-line').forEach(l => {
                        l.classList.remove('selected');
                    });
                    
                    // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–æ–∫—É
                    this.classList.add('selected');
                    selectedAnswers = [index + 1];
                });
                
                container.appendChild(lineDiv);
            });
            
            elements.answerContainer.appendChild(container);
        }
        
        // –°–æ–±–µ—Ä–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É
        function loadBuildProgram(question) {
            const container = document.createElement('div');
            
            // –û–±–ª–∞—Å—Ç—å —Å –±–ª–æ–∫–∞–º–∏
            const blocksDiv = document.createElement('div');
            blocksDiv.className = 'build-program';
            
            question.blocks.forEach((block, index) => {
                const blockElement = document.createElement('div');
                blockElement.className = 'code-block';
                blockElement.textContent = block;
                blockElement.dataset.index = index;
                
                // –î–µ–ª–∞–µ–º –±–ª–æ–∫ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ–º—ã–º
                makeDraggable(blockElement, blocksDiv);
                blocksDiv.appendChild(blockElement);
            });
            
            // –û–±–ª–∞—Å—Ç—å –¥–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã
            const programArea = document.createElement('div');
            programArea.className = 'program-area';
            programArea.id = 'programArea';
            
            container.appendChild(blocksDiv);
            container.appendChild(programArea);
            elements.answerContainer.appendChild(container);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        function makeDraggable(element, container) {
            let isDragging = false;
            let startX, startY;
            let initialIndex;
            
            element.addEventListener('touchstart', startDrag, {passive: false});
            element.addEventListener('mousedown', startDrag);
            
            function startDrag(e) {
                isDragging = true;
                element.classList.add('dragging');
                
                const rect = element.getBoundingClientRect();
                startX = (e.clientX || e.touches[0].clientX) - rect.left;
                startY = (e.clientY || e.touches[0].clientY) - rect.top;
                initialIndex = Array.from(container.children).indexOf(element);
                
                document.addEventListener('touchmove', drag, {passive: false});
                document.addEventListener('touchend', stopDrag);
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', stopDrag);
                
                e.preventDefault();
            }
            
            function drag(e) {
                if (!isDragging) return;
                
                const x = (e.clientX || e.touches[0].clientX) - startX;
                const y = (e.clientY || e.touches[0].clientY) - startY;
                
                element.style.position = 'fixed';
                element.style.left = x + 'px';
                element.style.top = y + 'px';
                element.style.zIndex = '1000';
                element.style.width = element.offsetWidth + 'px';
                
                e.preventDefault();
            }
            
            function stopDrag(e) {
                if (!isDragging) return;
                
                isDragging = false;
                element.classList.remove('dragging');
                element.style.position = '';
                element.style.left = '';
                element.style.top = '';
                element.style.zIndex = '';
                element.style.width = '';
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫—É–¥–∞ –±—ã–ª –ø–µ—Ä–µ–º–µ—â–µ–Ω —ç–ª–µ–º–µ–Ω—Ç
                const dropX = e.clientX || (e.changedTouches && e.changedTouches[0].clientX);
                const dropY = e.clientY || (e.changedTouches && e.changedTouches[0].clientY);
                
                if (dropX && dropY) {
                    const programArea = document.getElementById('programArea');
                    const programRect = programArea?.getBoundingClientRect();
                    
                    if (programRect && 
                        dropX >= programRect.left && 
                        dropX <= programRect.right &&
                        dropY >= programRect.top && 
                        dropY <= programRect.bottom) {
                        // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –≤ –æ–±–ª–∞—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã
                        programArea.appendChild(element);
                    }
                }
                
                document.removeEventListener('touchmove', drag);
                document.removeEventListener('touchend', stopDrag);
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('mouseup', stopDrag);
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞
        function checkAnswer() {
            const question = questions[currentQuestion];
            let isCorrect = false;
            
            switch (question.type) {
                case 'single':
                    isCorrect = selectedAnswers.length === 1 && 
                               selectedAnswers[0] === question.correct;
                    break;
                    
                case 'multiple':
                    if (selectedAnswers.length === question.correct.length) {
                        isCorrect = selectedAnswers.every(answer => 
                            question.correct.includes(answer)
                        );
                    }
                    break;
                    
                case 'matching':
                    const dropdowns = document.querySelectorAll('.matching-dropdown');
                    let allCorrect = true;
                    
                    dropdowns.forEach(dropdown => {
                        const term = dropdown.previousElementSibling.previousElementSibling.textContent;
                        const selectedValue = dropdown.value;
                        
                        if (question.correctPairs[term] !== selectedValue) {
                            allCorrect = false;
                        }
                    });
                    
                    isCorrect = allCorrect;
                    break;
                    
                case 'sequence':
                    const sequenceItems = document.querySelectorAll('.sequence-item');
                    const currentOrder = Array.from(sequenceItems).map(item => 
                        parseInt(item.dataset.index)
                    );
                    isCorrect = JSON.stringify(currentOrder) === 
                               JSON.stringify(question.correctOrder);
                    break;
                    
                case 'fill-blanks':
                    const blanks = document.querySelectorAll('.blank');
                    const filledCorrectly = Array.from(blanks).every((blank, index) => {
                        return blank.textContent === question.correct[index];
                    });
                    isCorrect = filledCorrectly && blanks.length === question.correct.length;
                    break;
                    
                case 'find-error':
                    isCorrect = selectedAnswers.length === 1 && 
                               selectedAnswers[0] === question.errorLine;
                    break;
                    
                case 'build-program':
                    const programBlocks = document.querySelectorAll('#programArea .code-block');
                    const programOrder = Array.from(programBlocks).map(block => 
                        parseInt(block.dataset.index)
                    );
                    isCorrect = JSON.stringify(programOrder) === 
                               JSON.stringify(question.correctOrder);
                    break;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            showResult(isCorrect, question.explanation);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç
            if (isCorrect) {
                score += 10;
                correctAnswers++;
                elements.score.textContent = score;
                elements.correct.textContent = correctAnswers;
                
                // –ê–Ω–∏–º–∞—Ü–∏—è —É—Å–ø–µ—Ö–∞
                document.querySelector('.question-block').classList.add('correct');
            }
            
            elements.nextBtn.style.display = 'block';
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        function showResult(isCorrect, explanation) {
            elements.explanationText.textContent = explanation;
            elements.explanation.classList.add('show');
            
            // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
            const question = questions[currentQuestion];
            
            if (question.type === 'single' || question.type === 'multiple') {
                document.querySelectorAll('.option-btn').forEach((option, index) => {
                    if (question.type === 'single') {
                        if (index === question.correct) {
                            option.classList.add('correct');
                        } else if (selectedAnswers.includes(index)) {
                            option.classList.add('incorrect');
                        }
                    } else if (question.type === 'multiple') {
                        if (question.correct.includes(index)) {
                            option.classList.add('correct');
                        } else if (selectedAnswers.includes(index) && !question.correct.includes(index)) {
                            option.classList.add('incorrect');
                        }
                    }
                });
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É
        function showHint(text) {
            elements.hintBubble.textContent = text;
            elements.hintBubble.classList.add('show');
            
            setTimeout(() => {
                elements.hintBubble.classList.remove('show');
            }, 3000);
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        function showResults() {
            const percentage = Math.round((correctAnswers / questions.length) * 100);
            const totalScore = score;
            
            let grade = '';
            let icon = '';
            let message = '';
            
            if (percentage >= 90) {
                grade = '–û—Ç–ª–∏—á–Ω–æ!';
                icon = 'üèÜ';
                message = '–¢—ã - —Å—É–ø–µ—Ä–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç!';
            } else if (percentage >= 70) {
                grade = '–•–æ—Ä–æ—à–æ!';
                icon = 'üëç';
                message = '–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!';
            } else if (percentage >= 50) {
                grade = '–ù–µ–ø–ª–æ—Ö–æ!';
                icon = 'üëå';
                message = '–¢—ã –Ω–∞ –≤–µ—Ä–Ω–æ–º –ø—É—Ç–∏!';
            } else {
                grade = '–ü–æ–ø—Ä–æ–±—É–π –µ—â–µ!';
                icon = 'üìö';
                message = '–ü–æ–≤—Ç–æ—Ä–∏ —Ç–µ–æ—Ä–∏—é –∏ –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è!';
            }
            
            elements.questionText.innerHTML = `
                <h2>${icon} –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!</h2>
                <p>–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ${correctAnswers}/${questions.length}</p>
                <p>–ù–∞–±—Ä–∞–Ω–æ –±–∞–ª–ª–æ–≤: ${totalScore}</p>
                <p>–û—Ü–µ–Ω–∫–∞: ${grade}</p>
                <p>${message}</p>
            `;
            
            // –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä
            const progressBar = document.createElement('div');
            progressBar.className = 'progress-bar';
            const progressFill = document.createElement('div');
            progressFill.className = 'progress-fill';
            progressFill.style.width = `${percentage}%`;
            progressBar.appendChild(progressFill);
            
            elements.answerContainer.innerHTML = `
                <div class="result-screen">
                    <div class="result-icon">${icon}</div>
                    <h3>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</h3>
                    <p>üéØ –ü–æ–≤—Ç–æ—Ä–∏ –æ—Å–Ω–æ–≤—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∏–∑–∞—Ü–∏–∏</p>
                    <p>üíª –ü—Ä–∞–∫—Ç–∏–∫—É–π—Å—è –≤ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –ø—Ä–æ—Å—Ç—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</p>
                    <p>üéÆ –ò–≥—Ä–∞–π –≤ —Ä–∞–∑–≤–∏–≤–∞—é—â–∏–µ –∏–≥—Ä—ã –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é</p>
                    <p>üìö –ß–∏—Ç–∞–π –∫–Ω–∏–≥–∏ –æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –¥–ª—è –¥–µ—Ç–µ–π</p>
                </div>
            `;
            
            elements.answerContainer.querySelector('.result-screen').prepend(progressBar);
            
            elements.explanation.style.display = 'none';
            elements.hintBtn.style.display = 'none';
            elements.checkBtn.style.display = 'none';
            elements.nextBtn.style.display = 'none';
            
            // –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
            const restartBtn = document.createElement('button');
            restartBtn.className = 'btn btn-success';
            restartBtn.innerHTML = '<i class="fas fa-redo"></i> –ò–≥—Ä–∞—Ç—å –µ—â–µ —Ä–∞–∑';
            restartBtn.style.marginTop = '30px';
            restartBtn.addEventListener('click', () => {
                location.reload();
            });
            
            elements.answerContainer.appendChild(restartBtn);
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Telegram
            setTimeout(() => {
                tg.sendData(JSON.stringify({
                    action: 'game_complete',
                    score: totalScore,
                    correct: correctAnswers,
                    total: questions.length,
                    percentage: percentage,
                    grade: grade
                }));
            }, 1000);
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ü–æ–¥—Å–∫–∞–∑–∫–∞
            elements.hintBtn.addEventListener('click', () => {
                const hints = [
                    "–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —á–∏—Ç–∞–π –≤–æ–ø—Ä–æ—Å! üìñ",
                    "–ü–æ–¥—É–º–∞–π –ª–æ–≥–∏—á–µ—Å–∫–∏! ü§î",
                    "–ù–µ —Ç–æ—Ä–æ–ø–∏—Å—å, —É —Ç–µ–±—è –µ—Å—Ç—å –≤—Ä–µ–º—è! ‚è≥",
                    "–ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ–π –æ—Ç–≤–µ—Ç –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π! ‚úÖ",
                    "–ï—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–π –º–µ—Ç–æ–¥ –∏—Å–∫–ª—é—á–µ–Ω–∏—è! üéØ"
                ];
                const randomHint = hints[Math.floor(Math.random() * hints.length)];
                showHint(randomHint);
            });
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞
            elements.checkBtn.addEventListener('click', checkAnswer);
            
            // –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å
            elements.nextBtn.addEventListener('click', () => {
                currentQuestion++;
                loadQuestion(currentQuestion);
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && elements.checkBtn.style.display !== 'none') {
                    checkAnswer();
                } else if (e.key === ' ' && elements.hintBtn.style.display !== 'none') {
                    elements.hintBtn.click();
                }
            });
        }
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', initGame);
        
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–º —Ç–∞–ø–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>
